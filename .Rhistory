library(RcppArmadillo)
paste0(1:1000,collapse=" ")
R.Version()
R.Version()
install.packages("RcppArmadillo")
library("RcppArmadillo", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
detach("package:RcppArmadillo", unload=TRUE)
install.packages("RcppArmadillo")
install.packages("RcppArmadillo")
install.packages("RcppArmadillo")
install.packages("RcppArmadillo")
install.packages(c('Rcpp', 'RcppArmadillo'))
install.packages(c('Rcpp', 'RcppArmadillo'))
Sys.getenv()
install.packages(c('Rcpp', 'RcppArmadillo'))
Rcpp::sourceCpp('~/Desktop/helloworld.cpp')
install.packages(c('Rcpp', 'RcppArmadillo'))
install.packages(c('Rcpp', 'RcppArmadillo'))
Rcpp::sourceCpp('~/Desktop/helloworld.cpp')
?Rcpp::compileAttributes()
library(multivar)
library(multivar)
library(multivar)
library(multivar)
library(multivar)
multivar::var_sim(100,mat(rnoorm(2),2,2), mat(rnoorm(2),2,2))
multivar::var_sim(100,matrix(rnoorm(2),2,2), matrix(rnoorm(2),2,2))
multivar::var_sim(100,matrix(rnorm(2),2,2), matrix(rnorm(2),2,2))
multivar::var_sim(100,diag(2), diag(2))
library(multivar)
multivar::var_sim(100,diag(2), diag(2))
multivar::var_sim(100,diag(2), diag(2))
library(multivar)
library(multivar)
multivar::var_sim(100,diag(2), diag(2))
library(multivar)
library(multivar)
library(multivar)
library(multivar)
library(multivar)
library(multivar)
library(multivar)
library(multivar)
theta    <- matrix(rnorm(9),3,3)
data     <- var_sim(20, theta, diag(.1,3))
datalag  <- embed(data, 2)
b        <- datalag[,1:3]
A        <- datalag[,4:6]
fista_sparse(A, b, 1, theta, niter = 1, backtrack = TRUE)
rm(list=ls(all=TRUE))
#------------------------------------------------------------------------------#
paper_sim <- 1
sim_iter  <- 6
#------------------------------------------------------------------------------#
main.dir <- "/Users/lola/Dropbox/Macbook/Authored/Papers/square root filter/sims/data"
set.seed(475)
AR12_70_orig <- cumsum(sample(c(-1, 1),  70 - round((2/11)*70), TRUE))
AR12_70_orig <- smooth(scales::rescale(AR12_70_orig, to = c(.4,.0)))
AR12_70      <- cbind(AR12_70_orig, index=1:( 70 - round((2/11)*70)))
AR12_70      <- loess(AR12_70_orig ~ index, data = as.data.frame(AR12_70), span=0.2)$fitted
set.seed(259)
AR21_70_orig <- cumsum(sample(c(-1, 1),  70 - round((2/11)*70), TRUE))
AR21_70_orig <- smooth(scales::rescale(AR21_70_orig, to = c(-0.6,-.0)))
AR21_70      <- cbind(AR21_70_orig, index=1:( 70 - round((2/11)*70)))
AR21_70      <- loess(AR21_70_orig ~ index, data = as.data.frame(AR21_70), span=0.3)$fitted
plot.ts(cbind(AR12_70,AR21_70))
set.seed(610)
AR12_200_orig <- cumsum(sample(c(-1, 1), 200, TRUE))
AR12_200_orig <- smooth(scales::rescale(AR12_200_orig, to = c(0,.5)))
AR12_200      <- cbind(AR12_200_orig, index=1:200)
AR12_200      <- loess(AR12_200_orig ~ index, data = as.data.frame(AR12_200), span=0.4)$fitted
set.seed(311)
AR21_200_orig <- cumsum(sample(c(-1, 1), 200, TRUE))
AR21_200_orig <- smooth(scales::rescale(AR21_200_orig, to = c(-0.0,-.6)))
AR21_200      <- cbind(AR21_200_orig, index=1:200)
AR21_200      <- loess(AR21_200_orig ~ index, data = as.data.frame(AR21_200), span=0.2)$fitted
plot.ts(cbind(AR12_200,AR21_200))
set.seed(317)
AR12_500_orig <- cumsum(sample(c(-1, 1), 500, TRUE))
AR12_500_orig <- smooth(scales::rescale(AR12_500_orig,  to = c(.0,.5)))
AR12_500      <- cbind(AR12_500_orig, index=1:500)
AR12_500      <- loess(AR12_500_orig ~ index, data = as.data.frame(AR12_500), span=0.4)$fitted
set.seed(108)
AR21_500_orig <- cumsum(sample(c(-1, 1), 500, TRUE))
AR21_500_orig <- smooth(scales::rescale(AR21_500_orig, to = c(-0.6,-.0)))
AR21_500      <- cbind(AR21_500_orig, index=1:500)
AR21_500      <- loess(AR21_500_orig ~ index, data = as.data.frame(AR21_500), span=0.4)$fitted
plot.ts(cbind(AR12_500,AR21_500))
set.seed(123)
U1_70  <- c(rep(0,1000), rep(0, round((2/11)*70)), AR12_70)
U2_70  <- c(rep(0,1000), rep(0, round((2/11)*70)), AR21_70)
U1_200 <- c(rep(0,1000), rep(0, round((2/11)*200)), AR12_200)
U2_200 <- c(rep(0,1000), rep(0, round((2/11)*200)), AR21_200)
U1_500 <- c(rep(0,1000), rep(0, round((2/11)*500)), AR12_500)
U2_500 <- c(rep(0,1000), rep(0, round((2/11)*500)), AR21_500)
X1_70  <- X2_70  <- c(rep(0,1000), rep(0, round((2/11)*70)), rep(1, 70 - round((2/11)*70)))
X1_200 <- X2_200 <- c(rep(0,1000), rep(0, round((2/11)*200)), rep(1, 200 - round((2/11)*200)))
X1_500 <- X2_500 <- c(rep(0,1000), rep(0, round((2/11)*500)), rep(1, 500 - round((2/11)*500)))
X_70 <- t(cbind(X1_70,X2_70))
U_70 <- t(cbind(U1_70,U2_70))
X_200 <- t(cbind(X1_200,X2_200))
U_200 <- t(cbind(U1_200,U2_200))
X_500 <- t(cbind(X1_500,X2_500))
U_500 <- t(cbind(U1_500,U2_500))
X_70
plot.ts(cbind(U_70))
plot.ts(t(cbind(U_70)))
rm(list=ls(all=TRUE))
#------------------------------------------------------------------------------#
# SIMULATION SET 1
#------------------------------------------------------------------------------#
main.dir <- "/Users/lola/Dropbox/Macbook/Authored/Papers/square root filter/sims/data"
set.seed(475)
AR12_70_orig <- cumsum(sample(c(-1, 1),  70 - round((2/11)*70), TRUE))
AR12_70_orig <- smooth(scales::rescale(AR12_70_orig, to = c(.4,.0)))
AR12_70      <- cbind(AR12_70_orig, index=1:( 70 - round((2/11)*70)))
AR12_70      <- loess(AR12_70_orig ~ index, data = as.data.frame(AR12_70), span=0.2)$fitted
set.seed(259)
AR21_70_orig <- cumsum(sample(c(-1, 1),  70 - round((2/11)*70), TRUE))
AR21_70_orig <- smooth(scales::rescale(AR21_70_orig, to = c(-0.6,-.0)))
AR21_70      <- cbind(AR21_70_orig, index=1:( 70 - round((2/11)*70)))
AR21_70      <- loess(AR21_70_orig ~ index, data = as.data.frame(AR21_70), span=0.3)$fitted
plot.ts(cbind(AR12_70,AR21_70))
set.seed(610)
AR12_200_orig <- cumsum(sample(c(-1, 1), 200, TRUE))
AR12_200_orig <- smooth(scales::rescale(AR12_200_orig, to = c(0,.5)))
AR12_200      <- cbind(AR12_200_orig, index=1:200)
AR12_200      <- loess(AR12_200_orig ~ index, data = as.data.frame(AR12_200), span=0.4)$fitted
set.seed(311)
AR21_200_orig <- cumsum(sample(c(-1, 1), 200, TRUE))
AR21_200_orig <- smooth(scales::rescale(AR21_200_orig, to = c(-0.0,-.6)))
AR21_200      <- cbind(AR21_200_orig, index=1:200)
AR21_200      <- loess(AR21_200_orig ~ index, data = as.data.frame(AR21_200), span=0.2)$fitted
plot.ts(cbind(AR12_200,AR21_200))
set.seed(317)
AR12_500_orig <- cumsum(sample(c(-1, 1), 500, TRUE))
AR12_500_orig <- smooth(scales::rescale(AR12_500_orig,  to = c(.0,.5)))
AR12_500      <- cbind(AR12_500_orig, index=1:500)
AR12_500      <- loess(AR12_500_orig ~ index, data = as.data.frame(AR12_500), span=0.4)$fitted
set.seed(108)
AR21_500_orig <- cumsum(sample(c(-1, 1), 500, TRUE))
AR21_500_orig <- smooth(scales::rescale(AR21_500_orig, to = c(-0.6,-.0)))
AR21_500      <- cbind(AR21_500_orig, index=1:500)
AR21_500      <- loess(AR21_500_orig ~ index, data = as.data.frame(AR21_500), span=0.4)$fitted
plot.ts(cbind(AR12_500,AR21_500))
set.seed(123)
U1_70  <- c(rep(0,1000), rep(0, round((2/11)*70)), AR12_70)
U2_70  <- c(rep(0,1000), rep(0, round((2/11)*70)), AR21_70)
U1_200 <- c(rep(0,1000), rep(0, round((2/11)*200)), AR12_200)
U2_200 <- c(rep(0,1000), rep(0, round((2/11)*200)), AR21_200)
U1_500 <- c(rep(0,1000), rep(0, round((2/11)*500)), AR12_500)
U2_500 <- c(rep(0,1000), rep(0, round((2/11)*500)), AR21_500)
X1_70  <- X2_70  <- c(rep(0,1000), rep(0, round((2/11)*70)), rep(1, 70 - round((2/11)*70)))
X1_200 <- X2_200 <- c(rep(0,1000), rep(0, round((2/11)*200)), rep(1, 200 - round((2/11)*200)))
X1_500 <- X2_500 <- c(rep(0,1000), rep(0, round((2/11)*500)), rep(1, 500 - round((2/11)*500)))
X_70 <- t(cbind(X1_70,X2_70))
U_70 <- t(cbind(U1_70,U2_70))
X_200 <- t(cbind(X1_200,X2_200))
U_200 <- t(cbind(U1_200,U2_200))
X_500 <- t(cbind(X1_500,X2_500))
U_500 <- t(cbind(U1_500,U2_500))
#------------------------------------------------------------------------------#
length <- 70
#------------------------------------------------------------------------------#
niter  <- 500
burnin <- 1000
nx     <- 2
nz     <- 6
nu     <- 0
dat <- list()
jj <- 1
cnt <- 1
FF <- diag(c(.7, .5),nx,nx)
#FF[1,2] <-  -0.2
#FF[2,1] <-  -0.3
QQ <- diag(1,nx,nx)
RR <- diag(.2,nz,nz)
HH <- lavaan::lav_matrix_bdiag(matrix(1,3,1),matrix(1,3,1))
xx <- matrix(0,nx,burnin+length)
zz <- matrix(0,nz,burnin+length)
vv <- t(mvtnorm::rmvnorm((burnin+length),rep(0, ncol(RR)),RR))
ww <- t(mvtnorm::rmvnorm((burnin+length),rep(0, ncol(QQ)),QQ))
mu_x0    <- rep(0, nx)
sigma_x0 <- diag(1,nx,nx)
xx_0     <- t(mvtnorm::rmvnorm(1,mu_x0,sigma_x0))
library(multivar)
library(multivar)
library(multivar)
